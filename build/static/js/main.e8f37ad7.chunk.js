(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{202:function(e,t){e.exports="\nwindow.addEventListener(\"keydown\", function(event) {\n    switch (event.keyCode) {\n        case 74: // 'j'\n        case 78: // 'n'\n            event.stopPropagation();\n            console.log(\"j\");\n    }\n});\n"},204:function(e,t,n){var s={"./base.css":205,"./html.css":206};function i(e){var t=o(e);return n(t)}function o(e){if(!n.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}i.keys=function(){return Object.keys(s)},i.resolve=o,e.exports=i,i.id=204},205:function(e,t,n){},206:function(e,t,n){},207:function(e,t,n){var s={"./container/AppContainer.css":208,"./container/PDFViewerContainer/PDFViewerContainer.css":209,"./project/PDFFindList/PDFFindList.css":210,"./project/PDFViewer/PDFViewer.css":211};function i(e){var t=o(e);return n(t)}function o(e){if(!n.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}i.keys=function(){return Object.keys(s)},i.resolve=o,e.exports=i,i.id=207},208:function(e,t,n){},209:function(e,t,n){},210:function(e,t,n){},211:function(e,t,n){},212:function(e,t,n){"use strict";n.r(t);var s=n(8),i=n(35),o=n.n(i),r=n(2),a=n.n(r),c=n(36),d=n.n(c);var u=new class{constructor(){this.context=null}};n(197);n(198),n(199);var p=n(93);const h=n(59),l=n(14),m=n(21),f="REPOSITORY_CHANGE";class _ extends m{constructor(e,t=new h){super(),this.DomainClass=e,this._database=t,this._name=this.DomainClass.name}_get(e){return this._database.get(`${this._name}.${e}`)}findById(e){return this._get(e)}lastUsed(){const e=this._database.get(`${this._name}.lastUsed`);if(e)return this._get(e.id)}save(e){l(e instanceof this.DomainClass,`Save only ${this.DomainClass.name} instance`),this._database.set(`${this._name}.lastUsed`,e),this._database.set(`${this._name}.${e.id}`,e),this.emit(f,e)}remove(e){this._database.delete(`${this._name}.${e}`),this.emit(f)}onChange(e){this.on(f,e)}}let w=0;class g{constructor({document:e}){this.id=w++,this.document=e}changeDocument(e){this.document!==e&&(this.document=e)}}var v=new class extends _{constructor(){super(g)}};let F=0;class C{constructor({url:e}){this.id=F++,this.url=e}}class D extends s.UseCase{static create(){return new this({pdfViewerRepository:v})}constructor({pdfViewerRepository:e}){super(),this.pdfViewerRepository=e}execute({url:e}){const t=this.pdfViewerRepository.lastUsed(),n=new C({url:e});t.changeDocument(n),this.pdfViewerRepository.save(t)}}const E=n(2),L=n(92),y=window.require("electron").shell,b=e=>{/^https?:/.test(e)&&y.openExternal(e,{activate:!0})};class P extends E.Component{static get propTypes(){return{url:E.PropTypes.string,onLoad:E.PropTypes.func,onFind:E.PropTypes.func,onFindClose:E.PropTypes.func,onDrop:E.PropTypes.func}}static get PDFJS_VIEWER_HTML(){return"./pdfjs/web/viewer.html"}get PDFViewerApplication(){if(this.iframe)return this.iframe.contentWindow.PDFViewerApplication}set page(e){if(!this.iframe)return;const t=this.iframe.contentWindow.PDFViewerApplication;t.page=e,t.pdfHistory.push({hash:`#page=${e}`,page:e})}constructor(){super(),this.iframe=null,this._onDragOver=(e=>{e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}),this._onDrop=(e=>{"function"===typeof this.props.onDrop&&this.props.onDrop(e)}),this._onDocumentLoad=(()=>{"function"===typeof this.props.onLoad&&this.props.onLoad(this.PDFViewerApplication.url),this.iframe.focus()}),this._onIframeLoad=(()=>{this._addEventToIframe()}),this._onDocumentClick=(e=>{e.preventDefault(),b(e.target.href)}),this._onFind=(e=>{this.props.onFind(e)}),this._onFindClose=(e=>{this.props.onFindClose(e)})}shouldComponentUpdate(e){return this.PDFViewerApplication?this.PDFViewerApplication.url!==e.url:e.url!==this.props.url}componentWillUnmount(){this.iframe.contentWindow.removeEventListener("documentload",this._onDocumentLoad)}componentWillUpdate(){this._addEventToIframe()}render(){const e=L.stringify({file:this.props.url});return E.createElement("iframe",{className:"PDFViewer",src:`${P.PDFJS_VIEWER_HTML}?${e}`,ref:e=>this.iframe=e,onLoad:this._onIframeLoad,allowFullScreen:!0})}_addEventToIframe(){const e=this.iframe;if(!e)return;const t=e.contentWindow;t.removeEventListener("documentload",this._onDocumentLoad),t.document.removeEventListener("drop",this._onDrop),t.document.removeEventListener("dragover",this._onDragOver),t.document.removeEventListener("click",this._onDocumentClick),t.removeEventListener("find",this._onFind),t.removeEventListener("findagain",this._onFind),t.removeEventListener("findclose",this._onFindClose),t.addEventListener("documentload",this._onDocumentLoad),t.document.addEventListener("drop",this._onDrop),t.document.addEventListener("dragover",this._onDragOver),t.document.addEventListener("click",this._onDocumentClick),t.addEventListener("find",this._onFind),t.addEventListener("findagain",this._onFind),t.addEventListener("findclose",this._onFindClose)}_injectPluginToWebView(){const e=this.iframe;e&&[n(202)].forEach(t=>{e.executeJavaScript(t)})}}const V=n(2);class x extends V.Component{render(){return V.createElement("li",{className:this.props.className,onClick:this.props.onClick},V.createElement("span",{className:"PDFFindListItem-pageNumber"},this.props.pageNumber),this.props.children)}}class T extends a.a.Component{static get propTypes(){return{items:a.a.PropTypes.array,onItemClick:a.a.PropTypes.func}}render(){if(!this.props.active)return null;const e=this.props.items.map(e=>{return a.a.createElement(x,{className:"PDFFindList-item",key:e.text,pageNumber:e.pageNumber,onClick:t=>{this.props.onItemClick(t,e)}},e.text)});return a.a.createElement("div",{className:"PDFFindList"},a.a.createElement("ul",{className:"PDFFindList-main"},e))}}class k{update(e){}reduce(e){throw new Error("should implement `MyStore#reduce(payload)`")}equals(e){return this===e||Object.keys(this).every(t=>this[t]===e[t])}}class O extends k{constructor(e={}){super(),this.url=e.url}update(e){return e.document.url?new O(Object.assign({},this,{url:e.document.url})):this}reduce(e){return e.type,this}}class R extends a.a.Component{static get propTypes(){return{pdfViewer:a.a.PropTypes.instanceOf(O).isRequired}}constructor(){super(),this._isUpdateingFindResults=!1,this._isUpdateingTimer=null,this.pdfViewer=null,this.state={matchPages:[],findBarActive:!1},this._boundOnDrop=this._onDrop.bind(this),this._boundOnLoad=this._onLoad.bind(this),this._boundOnFind=this._onFind.bind(this),this._boundOnFindClose=this._onFindClose.bind(this),this.boundOnItemClick=this._onItemClick.bind(this)}render(){const e=this.props.pdfViewer;return a.a.createElement("div",{className:"PDFViewerContainer"},a.a.createElement(T,{items:this.state.matchPages,active:this.state.findBarActive,onItemClick:this.boundOnItemClick}),a.a.createElement(P,{ref:e=>this.pdfViewer=e,url:e.url,onLoad:this._boundOnLoad,onDrop:this._boundOnDrop,onFind:this._boundOnFind,onFindClose:this._boundOnFindClose}))}_onLoad(e){u.context.useCase(D.create()).execute({url:e})}_onDrop(e){e.preventDefault();const t=e.dataTransfer.files,n=Object(p.a)(t,1)[0];n&&u.context.useCase(D.create()).execute({url:n.path})}_onFind(e){const t=e.target.PDFViewerApplication;t.findBar.highlightAll.checked=!0,requestAnimationFrame(()=>{this._updateFindResults(t)})}_onFindClose(e){clearTimeout(this._isUpdateingTimer),this.setState({matchPages:[],findBarActive:!1}),this._isUpdateingFindResults=!1}_updateFindResults(e){if(this._isUpdateingFindResults)return void(this._isUpdateingTimer=setTimeout(()=>{this._updateFindResults(e)},100));this._isUpdateingFindResults=!0;const t=e.findController.pageMatches.map((t,n)=>0===t.length?null:{pageNumber:n+1,text:e.findController.pageContents[n]}).filter(e=>null!=e);this.setState({matchPages:t,findBarActive:!0}),this._isUpdateingFindResults=!1,Object.keys(e.findController.pendingFindMatches).length&&(this._isUpdateingTimer=setTimeout(()=>{this.state.findBarActive&&this._updateFindResults(e)},500))}_onItemClick(e,t){this.pdfViewer&&(this.pdfViewer.page=t.pageNumber)}}class U extends a.a.Component{constructor(){super(),this.state=u.context.getState(),this.unListen=(()=>{})}componentWillMount(){const e=u.context;this.unListen=e.onChange(()=>{this.setState(e.getState())})}componentWillUnmount(){this.unListen&&this.unListen()}render(){const e=this.state.pdfViewer;return a.a.createElement("div",{className:"AppContainer"},a.a.createElement(R,{pdfViewer:e}))}}class N extends s.Store{constructor(){super(),this.state=null}setState(e){this.state.equals(e)||(this.state=e,this.emitChange())}}class I extends N{constructor({pdfViewerRepository:e}){super(),this.state=new O({}),e.onChange(this._onChange.bind(this))}getState(){return{pdfViewer:this.state}}_onChange(e){this.setState(this.state.update(e))}}class A{static create({url:e}={}){return new g({document:new C({url:e})})}}const S=n(92);function j(e){e.keys().forEach(e)}n(203),j(n(204)),j(n(207));const $=new s.QueuedStoreGroup([new I({pdfViewerRepository:v})]),W=new s.Context({dispatcher:new s.Dispatcher,store:$});(new o.a).startLogging(W),u.context=W;const B=S.parse(window.location.search.slice(1));u.context.useCase(class extends s.UseCase{static create(){return new this({pdfViewerRepository:v})}constructor({pdfViewerRepository:e}){super(),this.pdfViewerRepository=e}execute(e){const t=e.file||e._,n=A.create({url:t});this.pdfViewerRepository.save(n)}}.create()).execute(B).then(()=>{d.a.render(a.a.createElement(U,null),document.getElementById("root"))})},94:function(e,t,n){e.exports=n(212)}},[[94,1,2]]]);
//# sourceMappingURL=main.e8f37ad7.chunk.js.map